<%= render "components/banner_general" %>
<div class="container">
  <% if @campaign_active == false %>
    <div class="row">
      <div class="col-sm-12" style="text-align:center;">
         <h2 style="margin: 0 auto;font-weight: lighter;">Sorry, this Campaign is no longer active!</h2>
         <hr>
      </div>
    </div>
  <% end %>
  <% if @campaigns_backed.include?(@campaign.id)%>
  <div class="row">
    <div class="col-sm-12" style="text-align:center;">
       <h2 style="margin: 0 auto;font-weight: lighter;"><i class="far fa-check-circle"></i> Campaign Backed!</h2>
       <hr>
    </div>
  </div>
  <% end %>
  <div class="row">
    <div class="col-sm-2">
      <div class="user-info">
        <%= link_to profile_path(@campaign.user_id) do %>
          <p><%= cl_image_tag @campaign.user.profile_picture, width: 100 %></p>
          <p><small>By <%= @campaign_creator.first_name %> <%= @campaign_creator.last_name %></small></p>
        <% end %>
      </div>
    </div>
    <div class="col-sm-9">
      <h1 style="margin: 0;"><%= @campaign.name %></h1>
      <h4>
        <%= @campaign.date %> |
        <%= @campaign.address %>
      </h4>
    </div>
  </div>
  <div class="row">
    <div class="col-sm-8">
      <div class="campaign-photos">
        <%# @campaign.photos.each do |photo| %>
          <%#= cl_image_tag photo.image_url, class: 'img-responsive'%>
        <%# end %>
        <div id="carousel-example-generic" class="carousel slide" data-ride="carousel">
          <!-- Indicators -->
          <ol class="carousel-indicators">
            <% if @campaign.photos.count > 1 %>
              <li data-target="#carousel-example-generic" data-slide-to="0" class="active"></li>
              <% @campaign.photos[1..-1].each_with_index do |photo, index| %>
                <li data-target="#carousel-example-generic" data-slide-to="<%= index %>"></li>
              <% end %>
            <% end %>
          </ol>

          <!-- Wrapper for slides -->
          <div class="carousel-inner" role="listbox">
            <div class="item gallery-image-parent active" style="background-image: url('<%= cl_image_path @campaign.photos.first.image_url, height: 450, width: 900, crop: :fill %>')"></div>
            <% if @campaign.photos.count > 1 %>
              <% @campaign.photos[1..-1].each do |photo| %>
                <div class="item gallery-image-parent" style="background-image: url('<%= cl_image_path photo.image_url, height: 450, width: 900, crop: :fill %>')"></div>
              <% end %>
            <% end %>
          </div>

          <!-- Controls -->
          <% if @campaign.photos.count > 1 %>
            <a class="left carousel-control" href="#carousel-example-generic" role="button" data-slide="prev">
              <span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>
              <span class="sr-only">Previous</span>
            </a>
            <a class="right carousel-control" href="#carousel-example-generic" role="button" data-slide="next">
              <span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span>
              <span class="sr-only">Next</span>
            </a>
          <% end %>
        </div>
      </div>
      <div class="campaign-description">
        <%= @campaign.description %>
      </div>
    </div>
    <div class="row responsive">
      <div class="col-sm-12">
        <div class="ticket-category-boxes" style="box-shadow: 0px 0px 10px 0px rgba(156,156,156,1); 0px 0px 2px 1px rgba(0,0,0,0.75); none;">
          <h4>Amount Pledged: <%= humanized_money_with_symbol(@campaign.current_funding_amount) %></h4>
          <h5><%= @campaign.tickets.count %> Pledges Made</h5>
          <h5>The Goal is <%= humanized_money_with_symbol(@campaign.funding_goal) %></h5>
          <h4><strong><%= @campaign_days_left %></strong> <% if @campaign_days_left == 1 %> Day <% else %> Days <% end %> Left</h4>
        </div>
        <% if @campaign_active == true %>
          <%= simple_form_for :order, url: orders_path do |f| %>
            <%= f.input :campaign_id, as: :hidden, :input_html => { :value => @campaign.id } %>
              <%= simple_fields_for :categories do |c| %>
                <% @campaign.ticket_categories.each do |category| %>
                  <div class="col-sm-3 ticket-category-boxes">
                    <h4><%= category.name %> | <%= humanized_money_with_symbol(category.price) %></h4>
                    <p><small><%= category.description %></small></p>
                    <%= c.input "#{category.id}", collection: [1,2,3,4,5], label: "Quantity" %>
                  </div>
                <% end %>
                <div style="text-align: center;">
                  <%= f.submit 'Purchase', class: 'btn btn-primary' %>
                </div>
              <% end %>
          <% end %>
        <% end %>
      </div>
    </div>
  </div>
  <div class="space" style="height: 500px;">

  </div>
</div>
